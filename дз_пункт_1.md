
установка zfs:

apt update
apt upgrade

apt install zfsutils-linux -y
modprobe zfs

zfs --version
zfs-2.1.5-1ubuntu6~22.04.6
zfs-kmod-2.1.5-1ubuntu6~22.04.5



создаем четыре пула (в каждом 2 диска) в режиме RAID 1:

zpool create test_1 mirror /dev/sdb /dev/sdc
zpool create test_2 mirror /dev/sdd /dev/sde
zpool create test_3 mirror /dev/sdf /dev/sdg
zpool create test_4 mirror /dev/sdh /dev/sdi



добавляем для каждого пула разные алгоритмы сжатия:

zfs set compression=lzjb test_1
zfs set compression=lz4 test_2
zfs set compression=gzip test_3
zfs set compression=zle test_4

zfs get all | grep compression

test_1  compression           lzjb                   local
test_2  compression           lz4                    local
test_3  compression           gzip                   local
test_4  compression           zle                    local


копируем одинаковый текстовый файл (50Мб) на все пулы из домашней директории, результат zfs list:

cp /home/konstantin/20250715.ERL /test_1 ..... cp /home/konstantin/20250715.ERL /test_4

test_1  19.4M   813M     19.3M  /test_1
test_2  11.1M   821M     11.0M  /test_2
test_3  7.07M   825M     6.93M  /test_3
test_4  50.4M   782M     50.2M  /test_4


степень сжатия файлов :

zfs get all | grep compressratio | grep -v ref
test_1  compressratio         2.61x                  -
test_2  compressratio         4.57x                  -
test_3  compressratio         7.24x                  -
test_4  compressratio         1.00x                  -

видно, что самый эффективный алгоритм - gzip.




































